Tests of Continuum Theories as Models of Ion Channels. II. Poisson–Nernst–Planck Theory versus Brownian Dynamics
Ben Corry,* Serdar Kuyucak,† and Shin-Ho Chung* *Protein Dynamics Unit, Department of Chemistry, and †Department of Theoretical Physics, Research School of Physical Sciences, Australian National University, Canberra, Australian Capital Territory 0200, Australia
ABSTRACT We test the validity of the mean-field approximation in Poisson–Nernst–Planck theory by contrasting its predictions with those of Brownian dynamics simulations in schematic cylindrical channels and in a realistic potassium channel. Equivalence of the two theories in bulk situations is demonstrated in a control study. In simple cylindrical channels, considerable differences are found between the two theories with regard to the concentration profiles in the channel and its conductance properties. These differences are at a maximum in narrow channels with a radius smaller than the Debye length and diminish with increasing radius. Convergence occurs when the channel radius is over 2 Debye lengths. These tests unequivocally demonstrate that the mean-field approximation in the Poisson–Nernst–Planck theory breaks down in narrow ion channels that have radii smaller than the Debye length.
INTRODUCTION
In the previous article (Moy et al., 2000, hereafter called article I), we have tested the validity of the mean-field approximation in Poisson–Boltzmann (PB) theory, which is commonly used in potential energy calculations in ion channels. The PB theory is limited to equilibrium situations; to describe non-equilibrium processes such as ion transport, another continuum theory that is widely known as the Nernst–Planck (NP) electrodiffusion equation is used. The NP equation combines Ohm’s law for drift of ions in a potential gradient with Fick’s law of diffusion due to a concentration gradient (hence the name “drift-diffusion equation” is used in some fields). When the potential in the NP equation is determined from Poisson’s equation in a self-consistent manner, the combined system of equations form the Poisson–Nernst–Planck (PNP) theory, which provides a premium description of ion transport problems in many branches of physics and chemistry (e.g., Ashcroft and Mermin, 1976; Bockris and Reddy, 1970; Mason and McDaniel, 1988; Newman, 1991; Weiss, 1996). As in the case of the PB theory, these applications usually involve bulk conditions with system sizes much larger than the Debye length, and the validity of the underlying mean-field approximation is well established. Recent applications of the NP and PNP theories in ion channels (see Levitt, 1986; Cooper et al., 1988; Hille, 1992; Eisenberg, 1996, 1999 for reviews and further references), in contrast, involve systems with rather few ions and with dimensions smaller than the Debye length. Under these conditions, one would intuitively expect that keeping the integrity of ions would be essential
to gain a realistic physical description of the system, and the validity of the continuum approaches, where ions are represented as a continuous charge density, would be largely compromised. The most direct way of checking the validity of the PNP theory is to compare its predictions for various physical quantities (e.g., current and concentration) with those obtained from Brownian dynamics (BD) simulations, where individual ions are treated explicitly. The importance of such a test of PNP theory has been stressed in a recent series of commentaries on ion permeation by all participants (Levitt, 1999; McClesky, 1999; Miller, 1999; Nonner et al., 1999). Although molecular dynamics simulations (Roux and Karplus, 1994) are not yet at a stage to replace PNP theory in case of failure, BD simulations currently provide a genuine alternative for studying ion permeation in channels (Li et al., 1998; Chung et al., 1998, 1999; Hoyles et al., 1998a). In this article we test the PNP theory by comparing its predictions for conductance and concentration profiles in cylindrical channels and a potassium channel with those of BD simulations. We emphasize that both theories are applied to three-dimensional (3-D) channels without any simplifying assumptions that would reduce them to equivalent 1-D problems. Extension of both theories from effective 1-D channels to realistic 3-D cases has been achieved very recently (see Kurnikova et al., 1999 for PNP, and the BD references quoted above). The 3-D aspect of the channel structure is very important in settling such questions as the amount of shielding of dielectric forces on ions. In this respect, the earlier 1-D BD simulations of ion channels (Cooper et al., 1985; Jacobsson and Chiu, 1987; Bek and Jacobsson, 1994) provide only a limited testing ground for the continuum theories. We note that the continuum description of water in both BD and PNP is strictly valid in bulk situations, and the channel-water interactions are expected to play a role in ion permeation. These interactions can be directly taken into account in molecular dynamics studies. However, the infea
Received for publication 3 September 1999 and in final form 24 January 2000.
Address reprint requests and requests for the source codes of the programs to Dr. S. H. Chung, Protein Dynamics Unit, Department of Chemistry, Australian National University, Canberra, A.C.T. 0200, Australia. Tel.: 61-2-6249-2024; Fax: 61-2-6247-2792; E-mail: shin-ho.chung@anu.edu.au. © 2000 by the Biophysical Society 0006-3495/00/05/2364/18 $2.00
2364 Biophysical Journal Volume 78 May 2000 2364 –2381


sibility of molecular dynamics simulation of ion permeation with the currently available supercomputers necessitates a more phenomenological approach to the problem. One hopes that the effective parameters used in the phenomenological approaches (such as diffusion coefficient and dielectric constant) will all be determined from molecular dynamics studies eventually. This will provide a bridge between the microscopic and macroscopic approaches and a justification for the use of the latter theories. In the mean time, it is important to test the validity of various approximations going into the phenomenological theories to assess their suitability as models of membrane channels. Our comparison of PNP and BD in this article is carried out in this spirit. A summary of some of the results illustrated here was communicated elsewhere (Corry et al., 1999).
THEORETICAL METHODS
PNP theory
The PNP approach to ion permeation in membrane channels has been used in numerous papers in the last decade. Here we give an outline of the theory, and refer to the recent review articles by Eisenberg (1996, 1999) for further details and references. More recent references can be found in Chen et al. (1997, 1999), Nonner and Eisenberg (1998), and Kurnikova et al. (1999). In continuum theories, the flux J of each ion species is described by the NP equation, which combines the diffusion due to a concentration gradient with that from a potential gradient
J  Dn  zen
kT , (1)
here D, ze, and n are, respectively, the diffusion coefficient, charge, and number density of the ions of species . Note that n (in SI units) is related to the concentration of ions c (in moles/liter) through n  103NAc. The potential  in Eq. 1 is determined from the solution of Poisson’s equation
0  rr    
zen  ex, (2)
where  is the dielectric constant, the sum over  gives the charge density associated with the mobile ions in the electrolyte, and ex represents all the other external charge sources such as fixed or induced charges on a boundary. In the PNP theory, Eqs. 1 and 2 are solved simultaneously, yielding the potential, concentration, and flux of ions in the system. Note that both the ion concentration and flux are described by continuous quantities corresponding to macroscopic, space-time averages of microscopic motion of individual ions. Due to their nonlinear nature, the PNP equations are notoriously difficult to solve analytically except in some very special cases, e.g., the classic Goldman–Hodgkin–Katz equation (Hille, 1992). More recent discussions of the analytical treatment of the PNP equations can be found in Syganow and von Kitzing (1995, 1999a, b). Here we consider the basic formalism of the PNP together with some special cases to indicate where and why the PNP theory may break down. These solutions will also be used in checking the accuracy of the numerical results. When J  0 in Eq. 1, the PNP equations trivially reduce to the PB equation with the density given by the Boltzmann factor,
n  n0exp ,   ze/kT, (3)
where n0 denotes a reference density and  is the potential energy expressed in a dimensionless form. Using Eq. 3 for n as an integrating factor in Eq. 1, it can be recast into the form
J  Dexp nexp  . (4)
Under steady-state conditions and assuming a uniform flux J in the z direction, Eq. 4 reduces to 1-D and can be integrated to give
J  D
L  0
0
L exp z dz , (5)
where the values of   nexp( ) at the boundary points z  0 and L are specified with 0 and L, respectively. While Eq. 5 appears to require only the knowledge of the potential in the range [0, L], in fact, there is still a density dependence through Poisson’s equation (2). A similar expression for the density can be obtained by integrating Eq. 4 from 0 to z, and using Eq. 5 to eliminate J/D
nz  exp z  0   L  0 0
z exp z dz
0
L exp z dz, (6)
Finally, substituting Eq. 6 in Poisson’s equation, one obtains an integrodifferential equation for the potential in PNP
0
d
dzz d
dzz    
ze exp z
  0   L  0 0
z exp z dz
0
L exp z dz  ex. (7)
This is similar in form to the PB equation, and would reduce to it if L  0, that is, when the electrochemical forces balance out and the system is in equilibrium. In general, there are no known analytical solutions of Eq. 7, and applications of the 1-D PNP to ion channels have to be carried out using numerical methods (Eisenberg, 1996). For future reference, we quote here the trivial solutions of the PNP equations. When the concentration is uniform (n  n0 everywhere), one simply has Ohm’s law
J  Dzen0/kTL  0/L, (8)
while in the case of a uniform potential (i.e., no electric forces), the solutions are
J  DnL  n0/L,
nz  n0  nL  n0z/L. (9)
Because a self-consistent analytical solution of PNP equations is not possible, it is natural to look for approximations that will enable such solutions. Even if the potential could be determined in some way, there is still a problem in evaluating the integrals involving its exponential in Eqs. 5–7. In fact, the only known indefinite integral of exp[f(z)]dz is for f  z, which simply gives back exp(z). This corresponds to the constant field approximation in the Goldman–Hodgkin–Katz theory, and using (z)  0  ( L  0)z/L in Eqs. 5 and 6 yields the following solutions for the flux and density
J   D
L
 L  0 L  0
exp L  exp 0 , (10)
Poisson–Nernst–Planck versus Brownian Dynamics 2365
Biophysical Journal 78(5) 2364 –2381


nz  exp z
  0   L  0exp z  exp 0
exp L  exp 0 . (11)
The effect of the electrochemical forces on density, which is not so easy to surmise from Eq. 6, can be seen more clearly from Eq. 11: The density, which varies linearly between the boundary values when there are no electric forces (Eq. 9), exhibits an exponential behavior when there is a uniform field (to be more specific, the density of one type of ions is enhanced while that of the counterions is suppressed relative to the linear case, see Fig. 1 B). Thus the local potential has a significant effect on the cation and anion densities, as in the case of the PB theory. The question is then whether one can calculate this potential correctly in ion channels within the continuum approach using a continuous distribution of charges and mean-field approximation. If we use the BD results in article I as a guide, the answer has to be negative for narrow channels with radius smaller than the Debye length. We have already seen in article I that shielding is largely overestimated in PB theory, and leads to a gross reduction of the potential energy of an ion inside a channel. It is expected that shielding will play a similarly dominant role in the PNP calculations, leading to a largely distorted concentration (and hence current) values in narrow channels when compared to those of the BD simulations. To test this conjecture, a computer code has been written to solve the PNP equations in three dimensions for a range of channel shapes. In this code, a channel shape is constructed on a rectangular grid, and the PNP equations are solved at the grid points using a finite difference algorithm (see Appendix for details). The input of the program are the channel shape, dielectric constants in the channel and the protein wall, the concentrations and potentials on the reservoir boundaries, the diffusion coefficients of the ions, and the locations and strengths of fixed charges in the channel walls. Once these parameters are specified, the program outputs the concentration and potential throughout the system as well as the ionic currents through the channel. The PNP program is executed on an alpha cluster, where a typical run with 493 grid points takes 5–10 min. Inclusion of fixed charges in the channel wall roughly doubles the above computation time. When a finer mesh with 993 grid points is used, the computation time increases by more than an order of magnitude.
Tests of accuracy
As in the case of PB calculations in article I, the grid size has to be optimized for an efficient running of the PNP program. A smaller grid size improves accuracy of the results but requires a much longer run-time. To give an example, halving the grid size increases the computation time by a factor of 20. In most of the PNP calculations, we have used 493 grid points, which corresponds to grid sizes of 1–2 Å. An exception is the very narrow potassium channel, where a 993 grid is used. Smaller grid sizes would lead to slightly larger values of flux than presented in this study. Because we deal with potential and its integrals in PNP, rather than its derivative (i.e., force) as in PB, the results are found to be less sensitive to the grid size. A number of tests are carried out to check the validity and accuracy of the numerical solutions of the PNP equations in cylindrical channels. Since the only known analytical solutions of PNP are in 1-D, and our program is written for 3-D channels, we simulate this condition by varying the cylinder radius and making sure that the results are independent of the radius. The length of the channel is 25 Å and the same dielectric constant (  80) is used inside and outside the channel in testing to avoid 3-D effects arising from the induced boundary charges. The simplest checks are provided by either uniform concentration or uniform potential. The first case corresponds to Ohm’s law, and as shown in Fig. 1 A, the numerical PNP results for the I-V curve (filled circles) closely follow the line predicted by Eq. 8. Here a radius of 4 Å is used, but
similar agreements are obtained in channels with larger radius. Similarly, in the second case with a concentration gradient but no electric forces, the concentrations obtained from the PNP code (diamonds in Fig. 1 B) reproduce the linear change predicted by Eq. 9 (dashed line in Fig. 1 B). Again, this result is completely independent of the channel radius. As a final test, we consider the situation when there is both a potential gradient (0  L  100 mV) and a concentration gradient (c0  cL  400
FIGURE 1 Tests of the accuracy of the PNP code in a cylindrical channel with the same dielectric constant everywhere (  80). The length of the channel is 25 Å and results are independent of the radius unless otherwise stated. (A) A comparison of the current flowing through a cylindrical channel of radius 4 Å as found from the PNP code (circles) and from Eq. 8 (solid line). The concentration is set to 300 mM throughout and the potential between the ends of the channel is varied. (B) The concentration profiles of cations and anions in a cylindrical channel when a concentration difference is maintained between the ends (cL  100 mM and cR  500 mM). In the absence of an applied potential, the numerical results (diamonds) compare well with the analytical solution from Eq. 9 (dashed line). When a constant field is enforced, the numerical cation (filled circles) and anion (open circles) concentrations again follow closely the analytical results from Eq. 11 (solid lines). The exact PNP concentrations with self-consistent potentials are indicated by the triangles.
2366 Corry et al.
Biophysical Journal 78(5) 2364 –2381


mM). As noted above, an analytical solution exists only for a linearly varying applied potential, and therefore the PNP code is modified to include this as an option in the program. The anion and cation concentrations obtained from the PNP code, when the constant field condition is enforced, are compared to the analytical solutions from Eq. 11 in Fig. 1 B. As before, the agreement between the numerical and analytical solutions is very good regardless of the channel radius used. Naturally, one can also calculate the exact results from the PNP code with self-consistent potentials. In this case the 1-D character of the solutions is lost and a convergence study of the results with respect to the radius is required. Convergence is obtained when the channel diameter is comparable to its length. The exact results (after they converged) for the anion and cation concentrations are shown with the triangles in Fig. 1 B. It is seen that there are substantial differences between the exact concentrations and those obtained with the constant field approximation. This discrepancy is dependent on the applied potential and gets smaller with increasing voltage difference. The inadequacy of the constant field assumption in ion channels seen here has been stressed in earlier studies (Chen et al., 1997; Syganow and von Kitzing, 1999a).
Brownian dynamics
Brownian dynamics is relatively new in studies of ion permeation in channels, and not as well known as some other methods. It has been introduced to the field in the review article of Cooper et al. (1985), where a good introduction to the technique in 1-D channel models is given. Despite the encouraging disposition of this article toward BD, it has rarely been taken up in channel studies in the intervening years (Jacobsson and Chiu, 1987; Bek and Jacobsson, 1994). These earlier studies were limited to 1-D channels and could not be expected to model channel–ion interactions correctly. Very recently, we have extended BD simulations to 3-D channels, where all the ion– channel and ion–ion forces are correctly treated according to Poisson’s equation (Li et al., 1998; Chung et al., 1998, 1999; Hoyles et al., 1998a). The basic notions of BD simulations are given in the companion article (I). We do not repeat them here but discuss those features of BD specific to ion permeation, which are not mentioned in article I as only the equilibrium situations are considered there. The Langevin equation (see Eq. 9 in article I) is solved at discrete time steps following the algorithm devised by van Gunsteren and Berendsen (1982). A time step of t  100 fs is used in the BD simulations in general. In the potassium channel we use a multiple time step algorithm in BD code, as detailed in Chung et al. (1999). A shorter time step of 2 fs is used when an ion is either in the selectivity filter or near the entrance of the channel, where the force acting on an ion changes rapidly. Simulations lasting one or two million time steps are repeated 36 times in the cylindrical channel and 10 to 15 times in the potassium channel to obtain good statistics. A cylindrical reservoir with radius 30 Å is placed at each end of the channel and filled with ions. Its height is adjusted so that the average concentration in the channel/reservoir system remains at the desired value, usually 300 mM represented with a total of 48 ions. This larger value of the concentration than the physiological range ( 150 mM) is preferred to improve statistics in BD. Initially, the ions in the reservoirs are assigned random positions, with the provision that they do not overlap. Velocities are also assigned randomly according to the Boltzmann distribution. For successive simulations, the final positions and velocities of the ions in the previous simulation are used as initial positions and velocities in the next trial. Current is computed from the number of ions that pass through an imaginary plane at the middle of the channel during a simulation period. To maintain the specified concentrations in the reservoirs, a stochastic boundary is applied: when an ion crosses the channel, say from left to right, an ion of the same species is transplanted from the right reservoir to the left. For this purpose, the ion on the furthermost right-hand side is chosen, and it is placed far left-hand side of the left reservoir, making sure that it does not overlap with another ion. The stochastic boundary trigger points, located at either pore entrance, are checked at each time step of the
simulation. Concentration is determined from the time average of the number of ions in a given region. The BD program is executed on a Fujitsu VPP-300 supercomputer. With 48 ions in the system, the typical run time for a simulation period of 1.0 s (10 million time steps) is 16 h. A list of the parameters used in the BD simulations was given in article I. Here we include the mass, diffusion coefficient, and ion radii for K, which was not used in article I:
mK  6.5 1026 kg,
DK  1.96 109 m2 s1,
aK  1.33 Å.
The same values of the dielectric constants and diffusion coefficients are used in the PNP calculations.
RESULTS AND DISCUSSION
Comparisons of PNP theory with BD simulations are carried out in cylindrical channels with varying radius, and in a more realistic but complicated model of the potassium channel. The cylindrical channels are the most common geometry used in applications of the PNP approach, and therefore they are used in the majority of tests in the following. Further comparisons are carried out in a model potassium channel that is constructed from its recently revealed structure (Doyle et al., 1998). Unless otherwise stated, the average concentration in the system is kept at 300 mM in both PNP and BD. We note that the Debye length for a 300 mM solution is 5.6 Å.
Cylindrical channels
The cylindrical channel and reservoir system used in both the PNP calculations and the BD simulations is shown in Fig. 2 A. An identical system is used in article I, and as explained there, rounding of the corners is due to the difficulty of solving Poisson’s equation with sharp boundaries. The channel radius r is systematically increased from 3 Å to 14 Å, or from 0.5 to 2.5 times the Debye length. The dielectric constants are normally set to 80 in the electrolyte and 2 in the protein wall, except in a control study where protein  80 is used to simulate bulk conditions. We use the term “passive channel” to distinguish this non-interacting case from a real channel with protein  2. In these comparisons, bare channels (i.e., no fixed charges) are considered first, and then channels with fixed charges in the protein wall. To ensure that comparisons are carried out in nearly identical situations, we need to match the boundary conditions in PNP with those in BD. Due to the dynamic nature of simulations in BD, there are no unique procedures to implement these conditions. We use a relatively simple strategy here, which will be justified in the control studies below. The applied potential in BD is represented with a uniform electric field (usually E  107 V/m). The potential
Poisson–Nernst–Planck versus Brownian Dynamics 2367
Biophysical Journal 78(5) 2364 –2381


difference between the top and bottom boundaries is determined from the potential energy profile of a single ion in the presence of this electric field (see Fig. 2 B), which should yield a reasonable average value when the other ions are present. This potential difference is then used in the PNP
calculations. Similarly, the average concentrations in the reservoirs, determined from the number of ions in BD, are implemented in the PNP calculations. There is a slight complication here arising from the fact that concentrations in PNP are specified along the reservoir boundary which, in general, will not match their average values in the reservoir. This happens because any potential drop across the system produces a charge separation. Thus, one needs to find the correct boundary value that will reproduce the desired average concentration in the reservoir. To this end, we first run the PNP program in the absence of any electrolyte to find the potential drop V across the reservoir due to the applied voltage and channel shape. Away from the channel mouth, the charge separation would be expected to balance this potential drop according to the Nernst equation. Thus the ratio of concentrations at the two ends of the reservoir is given by
c1/c2  expeV/kT, (12)
which, together with the average concentration, cav  (c1  c2)/2, determines the appropriate boundary value for concentration. This procedure works well in most cases except when there are fixed charges in the channel or asymmetric solutions are used. These cause further distortions in concentration values that are not taken into account in the above method, with the result that the average concentration in the reservoir does not coincide with the desired value of cav. In such cases, the PNP runs are iterated until we find the values of c1 and c2 that satisfy the Nernst equation (Eq. 12) and the average concentration in the reservoir is equal to the desired value of cav.
Potential profiles
To motivate the comparison of PNP and BD, we first show the potential energy profiles for a cation moving along the central axis of a 4 Å radius channel under an applied electric field of 107 V/m (Fig. 2 B). These profiles are constructed from an electrostatic calculation with only one cation in the system using an iterative solution of Poisson’s equation (Hoyles et al., 1996, 1998b). For a passive channel (protein  80), this profile is linear, as indicated by the dotted line. In the case of a real channel with a dielectric boundary (protein  2), the profile (solid line) exhibits a large barrier due to the repulsive forces emanating from the surface charges induced by the ion. When other ions are present in the system, shielding effects might have a role in lowering this barrier and making it easier for ions to traverse the channel. The importance of this shielding in ion permeation has always been emphasized in applications of PNP (Eisenberg, 1996). However, we have demonstrated in article I that shielding effects predicted by the sister PoissonBoltzmann theory are overestimated in ion channels. Whether this conclusion, derived under equilibrium condi
FIGURE 2 (A) Cylindrical channel models used in comparisons of PNP theory with BD simulations. A 3-D channel model is generated by rotating the curve shown about the central axis by 180°. The cylindrical section is 25 Å in length, and the rounded corners have a radius of 5 Å. The radius of the cylinder r is varied from 3 to 14 Å. The reservoir height h is adjusted so as to keep the total (reservoir and channel) volume constant when the radius is changed. (B) The potential energy profiles in a cylindrical channel of radius r  4 Å when an electric field of 107 V/m is applied in the zˆ direction. The dashed and solid lines correspond to the channels with and without fixed charges, respectively. The profile of a passive channel (protein  80) is indicated by the dotted line.
2368 Corry et al.
Biophysical Journal 78(5) 2364 –2381


tions, changes when the system is in a state of flux can be addressed by performing BD simulations of the system and comparing the concentration and flux results with those obtained from PNP. Thus, in the following comparisons we specifically aim to address the issue of shielding and its impact on physically observable quantities. The energy barrier due to the induced surface charges can be lowered if one places negative charges on the protein walls. The potential energy profile of a cation, when eight monopoles with charges 0.09e are spread evenly around at the pore mouths (z  12.5 Å and z  12.5 Å), is shown by the dashed line in Fig. 2 B. Here, the strength of the fixed charges is chosen so that the potential barrier created by the induced charges is canceled out. Such fixed counter charges will be seen to be essential for ion permeation in narrow channels.
Control studies
For the comparisons of the PNP and BD results to be meaningful, we need to demonstrate first that they agree under bulk conditions. For this purpose, we perform a control study using a passive channel (protein  80) with a fairly large radius of r  14 Å. Because there are no induced surface charges in a passive channel, it does not interact with ions. This situation is similar to the bulk conditions, and concentrations obtained from BD via time averaging should agree with the PNP results. Concentration profiles are constructed from the BD simulations by dividing the channel into 16 layers, each with a width of 2.2 Å, as shown at the top of Fig. 3. The number of ions in each layer is counted at each time step, and then averaged over the entire simulation period. The average number of ions is then converted to an average concentration in each layer. To give an idea of the amount of charge separation, reservoirs are represented with two layers. Concentration profiles are similarly found in PNP by averaging over all the grid points in a given layer. The concentration profiles for the sodium ions with a symmetric solution of 300 mM in each reservoir and under an applied field of 107 V/m are shown in Fig. 3 A. The corresponding concentration profiles for the chloride ions are not shown because they exhibit an almost identical picture once inverted about the center of the channel. The BD results are represented by the histogram and the PNP results by the filled circles joined by a line. There is a general agreement between the PNP and BD results across the channel, with the average concentration remaining around 300 mM. A slight increase in the BD values at the mouth region [the left-hand side of (A) for Na ions] is due to the channel entrance effects. Ions hitting the rounded corners are bounced back most of the time, and as a result spend a slightly greater amount of time near the entrance. An opposite effect occurs for ions exiting the channel. As expected, these entrance and exit effects are enhanced in
FIGURE 3 Comparison of PNP with BD in a passive channel with a radius 14 Å and a symmetric solution of 300 mM in the reservoirs. The ions are driven across the channel with an applied field of E  107 V/m as indicated in the inset. (A) Concentration profiles of sodium ions (chloride ions exhibit a similar profile, hence not shown here). The channel is divided into 16 layers as shown by the dotted lines in the inset, and each reservoir into 2 layers. The average concentration values in layers are represented by the histograms in BD (reservoir values are shaded) and by the filled circles in PNP. (B) Conductance of Na and Cl ions in channels of different radii normalized by the cross-sectional area. The conductance found from the BD simulations is indicated by the filled (sodium) and open (chloride) circles, while those from the PNP theory are shown by the solid lines.
Poisson–Nernst–Planck versus Brownian Dynamics 2369
Biophysical Journal 78(5) 2364 –2381


channels with smaller radius, resulting in larger asymmetries between the left and right sides of the channel in BD simulations. A similar asymmetry occurs in PNP due to charge build-up but to a smaller extent. Thus the small discrepancy between the PNP and BD concentrations slightly increases at smaller radii. We note that there are also small differences between the reservoir values, especially in the layers next to the channel. This is mainly due to the different ways of handling the boundary conditions in the two methods. In BD, the average concentration in each reservoir is strictly maintained at 300 mM, and as a result, charge separation occurs only across the reservoirs despite the relatively large radius. In PNP, the approximate handling of the boundary conditions along the reservoir circumference (see Appendix), combined with the large radius of the channel, leads to charge separation across the channel. These differences in reservoir concentrations become smaller in realistic channels and seem to have little impact on channel flux, and therefore they are ignored in the present study. As a second control study we consider the flux through the channel, which should reveal a similar level of conformity as in the concentrations. To investigate possible channel size effects and as a reference for future comparisons, we present in Fig. 3 B the conductance results obtained in PNP and BD as a function of the channel radius as it is varied from r  3 Å to 14 Å. In these plots, the conductance has been normalized by the cross-sectional area of the channel to factor out the trivial increase in flux with the area. In PNP, this area is simply r2. In the case of BD, an effective radius of r  1 Å is used to take into account the hard-wall interaction that elastically scatters ions when they are within 1 Å of the channel wall. Both calculations are carried out with a symmetric solution of 300 mM and an applied field of 107 V/m. Note that with increasing radius, the reservoir height is reduced from 25 Å, which leads to slightly smaller applied potentials than 85 mV. There is a general agreement between the PNP calculations of the conductance (solid lines) and the BD results (circles) within the accuracy of computations. We emphasize that the use of an effective radius in BD results is essential in getting this agreement, which forms a reference point for future comparisons. Otherwise, there would be a large discrepancy between the PNP and BD results in Fig. 3 B. The anion conductance is greater than the cation conductance because the anions have a larger diffusion coefficient. The downward trend seen in both models follows a roughly 1/r relationship, which is due to the access resistance of the channel. The resistance of a cylinder with length L and radius r is given by L/ r2g, whereas its access resistance is 1/rg (Hall, 1975). Here g denotes the conductivity of ions. Combining the two resistances, one obtains a normalized conductance given by g/(L  r/4). Due to the rounded corners, the conductance shown in Fig. 3 B slightly deviates from this expression.
These control studies confirm that the two theories are properly calibrated in bulk situations. Thus, any discrepancies found in comparisons of PNP and BD in narrow channels with dielectric boundaries have to arise from differences in their treatment of the ion– channel and ion–ion interactions.
Bare channels
We first consider bare channels (i.e., protein  2 with no fixed charges), which illustrate with most clarity why and when the continuum assumptions in the PNP theory fail in ion channels. Effects of fixed charges in the protein wall will be discussed in the next subsection. Unless otherwise stated, in the following comparisons we use a symmetric solution of 300 mM and an applied field of 107 V/m, corresponding to a potential difference of 105 mV in an r  4 Å channel. In Fig. 4 we compare the concentration profiles found from PNP calculations (filled circles) with those constructed from the BD simulations (histograms) similar to Fig. 3 A, but for a channel with a radius of r  4 Å. Apart from a slight asymmetry caused by the applied potential, both sodium (A) and chloride (B) concentrations in PNP are seen to stay around the reservoir value of 300 mM throughout the channel. That is, PNP predicts that the sodium and chloride concentrations across the channel are nearly equal, leading to almost perfect shielding of ionic charges inside the channel. With equal amounts of positive and negative charge in the channel, surface charges induced by each are canceled by the other, and so there is no net induced surface charge. Thus ion– channel interaction is completely ignored in PNP, and charge is transported across the channel as if the dielectric boundary did not exist (i.e., protein  80). The BD results in Fig. 4 paint a completely different picture. Here the ion concentration drops exponentially as one moves into the channel, and it is more than an order of magnitude smaller than the reservoir values at the middle of the channel. This result simply follows from the fact that ions enter the channel singly most of the time, and meet a sharply rising potential energy barrier due to the induced boundary charges (see Fig. 2 B). This barrier, combined with the Boltzmann factor, reduces the probability of ions’ access to the channel interior exponentially. Due to fluctuations in ions’ energy, they have sufficient energy at times to cross the channel, which is why the concentrations do not completely vanish in the middle. Indeed, when the potential gradient in Fig. 4 is replaced with a relatively weaker concentration gradient (cL  100 mM and cR  500 mM), as shown in Fig. 5, the BD results drop even faster and the concentrations for both sodium and chloride vanish in most of the channel interior. The single ion barriers appear to remain mostly intact in the BD simulations, preventing ions from entering the channel interior, and thus they give no hint of shielding in narrow channels. The PNP concentrations in Fig. 5, however, increase almost linearly from left
2370 Corry et al.
Biophysical Journal 78(5) 2364 –2381


to right, following the prediction of Eq. 9 for a bulk electrolyte. The sodium and chloride concentrations are equal everywhere in the channel, and perfect shielding in PNP is again seen to lead to a radically different result compared to BD. The lack of shielding near a dielectric boundary in BD also has some effect on the reservoir concentrations. We see that the asymmetry caused by charge separation in the reservoirs in Fig. 3 A is canceled on the left-hand side of Fig. 4 A, but enhanced on the right-hand side. A similar but opposite effect is observed for Cl ions in Fig. 4 B. This simply results from ions being repelled from the protein boundary, leading to a zone of exclusion, and hence a
smaller effective volume in the reservoir layers next to the channel. Due to shielding, such an effect does not occur in PNP. The above examples clearly show that the concentrations predicted by PNP in narrow channels have no bearing at all with the time-averaged concentrations obtained from the BD simulations. This is in conformity with the observed breakdown of the continuum assumptions in the PB theory when the channel radius is smaller than the Debye length (see article I). With increasing channel radius, the discrepancies between the two theories should get smaller as one approaches to bulk conditions. To see where this happens, we show in Fig. 6 how the average concentrations in the two theories change with increasing radius. The PNP results for sodium (A) and chloride (B) are indicated by a single solid
FIGURE 4 Comparison of concentration profiles in PNP and BD as in Fig. 3 A but for a real channel (protein  2) with a radius r  4 Å. PNP concentrations are shown with filled circles and BD results with the histograms for sodium (A) and chloride (B) ions. A symmetric solution of 300 mM is used and 105 mV is applied between the boundaries.
FIGURE 5 Comparison of concentrations in an r  4 Å channel as in Fig. 4 but with asymmetric solutions (cL  100 mM and cR  500 mM) and no applied field.
Poisson–Nernst–Planck versus Brownian Dynamics 2371
Biophysical Journal 78(5) 2364 –2381


line because there is no visible dependence on the channel radius. Naturally, size doesn’t matter when there is no interaction between the channel and ions. In contrast, the concentrations in BD gradually increase with the channel size, and are expected to converge to the PNP results at around r  16 Å, i.e., about 3 Debye lengths. In large-radius channels, ions can remain further away from the channel walls, where the boundary forces are quite small. Also, the channel is often occupied by counterions leading to appreciable shielding (see below). Thus, the channel does not play a significant role in ion permeation any more, and the situation is more like in a bulk electrolyte. Though they are much suppressed in narrow channels, the sodium and chloride concentrations in BD are quite similar in magnitude. This raises the question of whether ions enter the channel in pairs or singly at different times. In the latter
case, similar average concentrations follow simply from the fact that both anions and cations see identical potential barriers as they enter the channel. To answer this question, we have carried out conditional probability studies in BD simulations by counting the number of anions in channel layers when a cation is in a specified layer. For example, when an Na ion is at the pore entrance (the second layer of the channel from the left in Fig. 4 A), the probability of finding a Cl ion in the channel is found to be 27%, that is, 3 out of 4 times ions enter the channel singly. This supports our assertion that counterions are not usually present to shield the electrostatic barriers to ion permeation in narrow channels. It is worthwhile to emphasize that even when there is a counterion in the channel so that it is neutral, one only gains a small shielding effect from its presence (see Fig. 4 in article I). Complete screening of an ion’s charge occurs only when counterions have space to move around the ion freely in all directions, which is obviously not possible in a narrow channel. When the radius of the channel is increased to 12 Å, the probability of finding a counterion in the channel rises to 100%. Thus shielding can play a more appreciable role in a wide channel both in terms of presence of counterions and available space. Because the potential and concentration are determined self-consistently in PNP, the errors committed in concentrations are expected to affect the potential results, and these in turn will lead to inaccuracies in the flux results. To illustrate the magnitude of these errors and how they change with the increasing channel size, in Fig. 7 we compare the normalized conductances in PNP and BD as a function of the radius (cf. Fig. 3 B). The PNP results for both the Na (A) and Cl (B) ions are almost the same as in Fig. 3 B for a passive channel, regardless of the channel size. This is a natural consequence of perfect shielding that prevents any ion– channel interaction. Thus, whether the dielectric constant of the protein is 2 or 80 makes almost no difference in PNP. The BD simulations show a dramatically different result: the conductance vanishes in an r  3 Å channel and is suppressed by an order of magnitude in other narrow channels. As the channel radius is increased further, the conductance obtained from BD rises rapidly, converging toward the predictions of PNP (and the passive channel results) at around 14 Å. The small discrepancy between the PNP and BD results at large radii is presumably due to the fact that the area used in the normalization of the conductance in BD would actually be smaller if the effect of the repulsive boundary is taken into account. Fig. 7 nicely summarizes the results in bare channels, depicting how shielding in PNP leads to an overestimate of current in narrow channels and where one could expect it to work again.
Fixed charges in the channel
Ion channels usually have excess charges in the protein wall that help permeation of one type of ions while discouraging
FIGURE 6 Similar to Fig. 4 but shows the changes in the concentration profiles in PNP (solid lines) and BD (dotted lines) as the channel radius is increased progressively from r  4 to 6, 8, and 12 Å. The concentration of sodium ions is shown in (A) and of chloride ions in (B).
2372 Corry et al.
Biophysical Journal 78(5) 2364 –2381


the counterions from entering the channel. Here we consider the case of a cation-selective channel by placing a set of negative charges in the walls near the each end of the channel. Eight monopoles with charges 0.09e are spread evenly around at z  12.5 Å and another set at z  12.5 Å. The effect of these charges on the potential profile of a cation, as shown in Fig. 2 B, is to cancel the barrier due to a bare channel with radius r  4 Å. For anions, the opposite happens and the barrier is roughly doubled. In PNP, the bias introduced by the fixed charges spoils the coexistence of cations and anions in the channel, and hence reduces the perfect shielding conditions that had been the source of problems in bare channels. As a result we expect the discrepancies between the PNP and BD results to get smaller.
The PNP and BD concentration profiles for a r  4 Å channel with fixed negative charges are compared in Fig. 8. This figure is obtained under identical conditions as in Fig. 4 except for the inclusion of the fixed charges. It is seen from Fig. 8 A that the sodium concentration has two sharp peaks adjacent to where the negative charges are located, and the agreement between PNP and BD in this region is quite reasonable. There is a sharp drop in the cation concentration between these peaks, and here the PNP results are a factor of 3– 4 larger than those of BD. The BD concentration is less than the average concentration of 300 mM, demonstrating that ions are still largely excluded from the central section of the channel because of the remnant energy barrier there (see Fig. 2 B). This also explains why the
FIGURE 7 Normalized conductance of Na (A) and Cl (B) ions in a bare channel are plotted against the channel radius as in Fig. 3 B. A symmetric solution of 300 mM and an applied potential of 105 mV are used. The BD results (circles) are fitted by the dotted line and the PNP results (diamonds) by the solid line. Each BD data point is obtained from a 3.6 s simulation period.
FIGURE 8 Comparison of concentrations in an r  4 Å channel as in Fig. 4 but with fixed charges in the protein wall. Eight monopoles, each with charge 0.09e, are distributed around each end of the channel. A symmetric solution of 300 mM and an applied potential of 105 mV are used.
Poisson–Nernst–Planck versus Brownian Dynamics 2373
Biophysical Journal 78(5) 2364 –2381


left-hand peak is higher than the right-hand one in BD, in contrast to PNP results, which correlate with the intuitive expectation that having a deeper potential well on the righthand side compared to the left should yield a larger concentration there (see Fig. 2 B). In fact, in BD simulations, cations have difficulty in crossing the central barrier from left to right, and therefore build up in the left-hand well. The chloride concentration in BD (Fig. 8 B) has a similar appearance as in Fig. 4 B, without fixed charges except that the larger barrier leads to an even stronger suppression of the concentration in the channel interior. The fixed charges also reduce the chloride concentration in PNP, but this effect is nowhere near as great as in BD. In the middle of the channel, the chloride concentration rises to 200 mM, which is an order of magnitude larger than in BD. Thus, we see that shielding in channels with fixed charges, though much reduced compared to the bare channels, is still quite effective in PNP. A study similar to Fig. 5, where the potential gradient is replaced by a concentration gradient, is not shown here because it gives much the same message as Fig. 8, once the asymmetry in the reservoir values is taken into account. To see when congruence of the two theories can be expected, we present in Fig. 9 a study of the average concentrations in PNP and BD as the channel radius is progressively increased from r  4 to 12 Å, similar to Fig. 6. One welcome change here compared to the bare channel is that the PNP results now depend on the channel radius. Fixed charges introduce back a size-dependent ion– channel interaction in PNP by destroying the perfect shielding conditions, and also via the direct Coulomb interaction. Although this improves the concentration profiles in PNP compared to BD, there are still sizable discrepancies at all radii shown, and a full convergence between the two theories occurs around 16 Å, as in the case of the bare channels (cf. Fig. 6). For a narrow channel, the presence of negative fixed charges greatly assists cations to cross the channel while hindering the anions further. Consequently, compared to the bare channels, we expect the cation conductance to increase significantly and the anion conductance to diminish. These effects are seen in both theories, however, as shown in Fig. 10, the extent to which conductance are enhanced or impeded and how this changes with the channel radius differ markedly between the two. In BD simulations, the induced surface charge effects still dominate the dynamics in narrow channels, and the cation current remains quite small despite the presence of fixed charges (Fig. 10 A). In contrast, the fixed charges greatly enhance the cation current in PNP, and as a result there is an order of magnitude discrepancy between PNP and BD in the r  3 Å channel. This discrepancy in the cation conductance drops to a factor of 2 at r  4 Å, and the PNP and BD results quickly converge after that as the channel gets wider. This relatively happy state of affairs, unfortunately, does not extend to the anion conduc
tance, which still suffers from shielding effects in PNP. The anion current in PNP is an order of magnitude larger compared to BD in narrow channels, and remains significantly higher as the radius is increased (Fig. 10 B). The fixed charges are less successful in excluding anions in PNP compared to BD because they are shielded out to a large extent. The conductance of both cations and anions in PNP and BD converge toward each other and to that expected without fixed charges when the channel radius becomes large. The differences in the limiting values are again presumably due to over- and under-estimation of the crosssectional area used in normalization of the current in BD. With fixed negative charges, a larger effective area than used is expected for cations and vice versa for anions, which will lead to a reduction in conductance for sodium ions and an increase for chloride ions. So far we have mainly considered channels with symmetric solutions and a fixed applied potential. Because most
FIGURE 9 Concentration profiles in PNP (solid lines) and BD (dotted lines) in cylindrical channels of differing radii as in Fig. 6 but with fixed charges.
2374 Corry et al.
Biophysical Journal 78(5) 2364 –2381


applications of PNP involve prediction of I-V curves in narrow channels with fixed charges and asymmetric solutions, it is worthwhile to compare PNP and BD in such a situation. For this purpose, we use an r  4 Å channel with the fixed charges placed as above and with the concentrations in the left and right reservoirs as cL  100 mM and cR  500 mM, respectively. In Fig. 11, the I-V curves obtained from the PNP calculations (diamonds fitted with solid lines) are compared with the BD results (circles fitted with dotted lines). The sodium current in PNP (Fig. 11 A) is similar (though not identical) to the prediction of the Goldman–Hodgkin–Katz equation. The zero point is shifted by the Nernst potential and the slopes for the negative and positive current ranges are different. Though much reduced compared to PNP, the sodium current in BD broadly exhib
its the same features at low voltages. An upswing in current observed near 150 mV is due to the central barrier becoming less of an impediment to permeation of Na ions with increasing driving force. The chloride current in PNP (Fig. 11 B), apart from a reduction in magnitude and inversion of the curve, is similar to the sodium current. In complete contrast, the chloride current in BD essentially vanishes at all applied voltages. As already noted above, shielding of fixed negative charges is responsible for the large anion currents in PNP, and lack of it in BD keeps the large potential barrier intact and prevents anions from crossing the channel. Anion– cation selectivity, which is simply achieved with the introduction of fixed charges in BD, is one of the problems in applications of PNP. There is no natural mechanism to implement it in PNP, and therefore artificially low values of diffusion coefficients have often been used to suppress the anion current. The range of ion diffusion coefficients that are appropriate for model chan
FIGURE 10 Normalized conductance of Na (A) and Cl (B) ions are plotted against the channel radius as in Fig. 7 but for a channel with fixed charges. The BD results (circles), representing a 3.6 s simulation period, are fitted by the dotted line and the PNP results (diamonds) by the solid line.
FIGURE 11 Comparison of I-V curves in PNP (diamonds fitted with solid lines) and BD (circles fitted with dotted lines) in an r  4 Å channel with fixed charges. An asymmetric solution with cL  100 mM and cR  500 mM is used. Each BD point represents a 1 s simulation period.
Poisson–Nernst–Planck versus Brownian Dynamics 2375
Biophysical Journal 78(5) 2364 –2381


nels used here are estimated from molecular dynamics studies and will be published in a forthcoming article. Another experimental quantity that is expected to exhibit large discrepancies between PNP and BD is the conductance– concentration curves. Because there is no limit to ion concentrations inside a channel, and no barriers to impede ions from crossing a channel, one intuitively expects that the observed saturation property of channels cannot be explained in PNP. In Fig. 12 we compare the conductanceconcentration curves obtained from PNP and BD in an r  4 Å channel with fixed charges. Symmetric solutions and an applied potential of 105 mV are used in this study. In PNP both the sodium (A) and chloride (B) conductance monotonically increase with concentration. Fixed negative
charges are seen to suppress the anion conductance quite successfully at small concentrations. But this situation is quickly rectified with increasing concentration and both anion and cation conductance reach a linear regime with similar slopes. Thus, no saturation of conductance is seen in PNP. To explain the observed saturation, nonelectrostatic mechanisms have been incorporated in the PNP formalism, such as suppressing the diffusion coefficient in a localized region near the fixed charges (Levitt, 1991a, b), or introducing different chemical potentials for each ion type (Nonner and Eisenberg, 1998). The connection of these ad hoc measures to the underlying electrostatic ion– channel interaction, however, is not clear. In BD, the sodium conductance exhibits the expected saturation property (A) while that of chloride vanishes, as in the case of the I-V curve (B). The latter is simply due to the large potential barrier seen by anions as before. Saturation of the sodium conductance, however, arises from the processing time required for the transit of a Na ion across the channel. If there were no barriers in the channel, this time would be very small and no saturation would have been observed within the range of concentrations used in Fig. 12. However, when ions enter the channel singly, there are residual potential barriers in the channel as seen in Fig. 2 B, and such barriers provide the rate-limiting step necessary for the saturation of conductance. The dielectric constant inside a channel, c, is not a well-determined quantity, and in narrow channels, it may well be much lower than 80. In the tests of PB theory in article I, use of a smaller dielectric constant has been shown to lead to a reduction in shielding, though this was not sufficient to procure an agreement with BD. We carry out a similar study here to see whether a reduction in c could lead to an improvement in PNP predictions. How this reduction is implemented inside a channel in the two theories has been described in article I, so it is not repeated here. The comparisons are done in an r  3 Å channel with a symmetric solution of 300 mM and an applied field of 107 V/m. The results for a bare channel are shown in Fig. 13 A and those for a channel with fixed charges in Fig. 13 B. Considering the significant increases in potential energy profiles when c is reduced (see Fig. 9 in article I), the current in PNP is hardly perturbed. It may seem perplexing that the rapid increase in the potential barrier height in PB theory does not lead to an even stronger suppression of the current in PNP. This is because the potential energy profiles in PB are obtained for a test ion with a full charge e, whereas ionic charge is distributed throughout the system in PNP and its value on a grid point is typically e/1000. Recalling that the Born energy is proportional to the charge squared, it is easy to see why a reduction in c makes almost no difference in PNP. In the same vein, the fixed charges increase the cation concentration by fourfold in PNP, and hence cause a little more reduction in the sodium current in Fig. 13 B compared to Fig. 13 A. In BD, the energy barriers increase with decreasing  in the channel, causing ionic currents to vanish
FIGURE 12 Conductance-concentration curves in PNP (diamonds fitted with solid lines) and BD (circles fitted with dotted lines) in an r  4 Å channel with fixed charges. Symmetric solutions and an applied potential of 105 mV are used. Each BD data point is derived from a 1 s simulation period.
2376 Corry et al.
Biophysical Journal 78(5) 2364 –2381


quickly even if they have not been already zero at c  80. Thus, a possible reduction in the dielectric constant in the channel will lead to larger discrepancies between PNP and BD due to the complete neglect of the Born energy in PNP. The fixed negative charges in the above study has been chosen so as to cancel the barrier seen by a cation in a bare channel. In applications of PNP, similar amounts of fixed charges are used. The presence of negative charges in the channel creates conditions conducive for cation conductance in BD and decreases shielding in PNP, thereby reducing the large discrepancies between the two theories ob
served in bare channels. An interesting question here is whether further improvements in PNP theory can be achieved by increasing the amount of fixed charges in the protein wall. This question will be addressed in the next section in the realm of the potassium channel, which has a highly charged protein wall.
Potassium channel
The cylindrical channels used in the last section provide only a schematic model for channels. It is of interest to repeat the tests of PNP and BD using a more realistic channel model. For this purpose we use the potassium channel whose crystal structure has been revealed in a recent x-ray study (Doyle et al., 1998). A thorough investigation of this channel using BD is given in Chung et al., 1999. Here we give a minimal description of the model channel necessary for the ensuing discussions. The shape of the channel is shown in Fig. 14 A. A cylindrical reservoir with radius 30 Å and variable length is connected to each
FIGURE 13 Effect of changing the dielectric constant inside an r  3 Å channel on sodium and chloride currents. The dielectric constant is kept at 2 in the protein. Both channels without (A) and with (B) fixed charges are considered. A symmetric solution of 300 mM and an applied field of 107 V/m are used. The PNP results are indicated by diamonds fitted with the solid lines. The BD results are shown with circles and mostly vanish.
FIGURE 14 (A) Cross-section of the potassium channel model. The positions of various dipole groups in the channel walls are indicated in the figure: filled circles show the oxygen atoms of carbonyl groups; open circles, the N-terminals of the helix dipoles; and filled diamonds, the mouth dipoles. Dipoles are spread with a fourfold symmetry about the z axis. (B) Changes in the potential profiles of a cation traversing the channel when the charge on the dipoles is 0 (a), 0.3 (b), 0.6 (c), and 0.9 (d)  1019 C.
Poisson–Nernst–Planck versus Brownian Dynamics 2377
Biophysical Journal 78(5) 2364 –2381


end of the channel. The dielectric constants are water  80, protein  2 as in the cylindrical channels. As shown below, for this narrow channel to conduct it must have fixed charges in the protein wall. These charge groups are modeled as sets of dipoles with fourfold symmetry about the z axis as follows: 1) four rings of four carbonyl groups are placed along the selectivity filter, located at z  10, 13.33, 16.67, and 20 Å. The negative pole of each carbonyl group (filled circles in Fig. 2 B) is placed 1 Å from the boundary, the positive pole 1.2 Å away from the negative pole, with their orientation perpendicular to the z axis; 2) four helix macrodipoles (open circles), with their N-terminals pointing at the oval chamber near the middle of the channel, are placed 90° apart. The positions of the N-terminals of the helix dipoles are z  10.66 Å and r  5.66 Å, and those of the C-terminals are z  22 Å and r  17 Å. The length of the dipole is 16 Å; 3) four “mouth” dipoles (filled diamonds) 5 Å in length are placed at each entrance of the channel. These are located at z  22.83 Å and z  20 Å. The absolute values of the charge on each end of each of the dipoles are estimated to be 0.6  1019 C, which yield an optimal current in BD (Chung et al., 1999). In one study, the charges on dipoles are varied simultaneously from 0 to 1.2  1019 C to see their effect on the conductance properties of the channel. To clarify the role of fixed charges and provide an intuitive understanding of the BD results, we first study the potential energy of an ion with varying fixed charges in the channel. Potential energy profiles of a single cation traversing the channel with an applied potential of 105 mV between the ends of the reservoirs are shown in Fig. 14 B. These profiles are constructed from numerical solutions of Poisson’s equation as explained for Fig. 2 B. The top plot (a) shows the potential energy in the channel when no dipoles are in place. Because the channel contains a very narrow selectivity filter with a radius of 1.5 Å, the potential barrier due to the induced boundary charges is too large (17 kT) for ions to surmount. When all the dipoles discussed above are included, this barrier can be turned into a potential well. Plots b– d show the potential energy profiles when the charges on each end of each of the dipoles are 0.3, 0.6, and 0.9  1019 C, respectively. The potential wells in c and d are very deep (24 and 45 kT, respectively), so that ions would have difficulty in climbing out of them on their own. Thus it is expected that the selectivity filter is permanently occupied by one or more ions in these cases. Both the PNP calculations and the BD simulations are carried out with an applied potential of 105 mV between the reservoir ends and an average concentration of 300 mM in each reservoir, which is represented by 16 ions of each species in BD. In Fig. 15 A we show how the conductance of the channel changes as the strength of the dipoles is increased. Without charges, both the potassium and chloride conductance vanish in BD. With increasing dipole charges, the barrier on Cl ions increases further, and its conduc
tance remains zero; therefore it is not shown in this figure. The potassium conductance in BD (filled circles joined with the dotted curve) exhibits an interesting behavior. It in
FIGURE 15 Conductance in a potassium channel. An applied voltage of 105 mV is maintained between the reservoir ends. (A) Variation of the conductance in a potassium channel as the absolute value of charge on each end of the 28 dipoles surrounding the channel is increased from 0 to 1.2  1019 C. A symmetric, 300 mM solution is used in the calculations. The conductance of potassium (filled diamonds) and chloride (open diamonds) in PNP are fitted with the solid lines. The BD results for potassium are shown with the filled circles joined with the dotted line. The chloride conductance vanishes, and therefore not shown. (B) Conductance-concentration study of the potassium channel when the charge on the dipoles is held at 0.6  1019 C. The results of PNP theory are shown by the diamonds and are fitted by the solid line, while those of BD simulations are shown by the filled circles and are fitted using the Michaelis–Menten equation (dotted line). The chloride conductance vanishes in both theories and hence is not shown. BD data points in A and B are obtained from a 2 s simulation period.
2378 Corry et al.
Biophysical Journal 78(5) 2364 –2381


creases at first with the charge, reaching a maximum value at 0.6  1019 C, and then decreases again. Explanation of this behavior requires analysis of multiple ion– channel interactions to find the residual barriers in the channel (see Chung et al., 1999). We do not enter such a discussion here, but simply note that the channel is occupied by two K ions on average in the optimal configuration. In the absence of charges, PNP predicts nearly equal conductance for potassium (filled diamonds in Fig. 15 A) and chloride (open diamonds), which is the result of the perfect shielding conditions as discussed in bare cylindrical channels earlier. With increasing dipole strength, the chloride conductance in PNP is quickly suppressed, vanishing at 0.3  1019 C. Thus the cation–anion selectivity in PNP can be achieved when the protein wall is highly charged. The potassium conductance in Fig. 15 A exhibits a parabolic behavior with a maximum at 0.7  1019 C, which may appear to mimic the conductance in BD, albeit at a much higher value. However, there are no barriers in PNP, and the reason for the drop in the conductance is actually due to the saturation and decrease of the potassium concentration in the center of the channel where there are no dipoles. Note that the dielectric constants in the channel are likely to be lower than 80, in which case the difference between the two theories will be amplified. For example, the conductance in BD drops by half when c  60 is used in the potassium channel instead of 80 (see Chung et al., 1999), whereas the PNP results are hardly affected by such a change (see Fig. 13). With the optimal choice of the dipole charges (0.6  1019 C), the agreement between PNP and BD appears reasonable given that it is such a narrow channel; the chloride conductance vanishes and the discrepancy in the potassium conductance is only a factor of 2. Though we have not presented a study of concentration here because it exhibits wild changes, a look at the total ionic charges in the channel will throw some light on this relatively successful outcome. The total cation and anion charges in the channel are, respectively, 2.7 and 0.27e in PNP and 2.1 and 0e in BD. The reason why the anion conductance is zero in PNP despite the presence of chloride ions in the channel is that its concentration vanishes in the highly charged regions of the channel, e.g., the selectivity filter. The dipoles are seen to lead to an order of magnitude difference between the cation and anion charges in PNP, which is sufficiently high to protect it from the undesired influences of shielding. To see whether PNP can maintain the above success at higher concentrations, we subject it to a final hurdle with a study of conductance– concentration relationship. With increasing average concentration in the reservoirs, the number of cations and anions stay more or less the same in BD, but monotonically increase in PNP. Worse, this increase is much faster for anions so that the anion/cation ratio rapidly grows with concentration, bringing the unwanted shielding back into the folds of PNP. The end result, as shown in Fig.
15 B, is that the potassium conductance in PNP does not saturate, but keeps growing with concentration. The BD simulations, however, reproduce the well-known saturation property of the potassium channel (see, e.g., Rae et al., 1988). The BD results in Fig. 15 B are fitted by the Michaelis–Menten equation (dotted lines)
I  Imax
1  Ks/c , (13)
where Imax, the saturation current, and Ks are fit parameters. As in the case of the cylindrical channel (Fig. 12), saturation of the conductance in the potassium channel arises from the residual barriers that ions have to surmount (see Chung et al., 1999 for a detailed discussion). On the positive side, the chloride conductance in PNP remains vanishingly small at all concentrations in agreement with BD. Despite the rapid growth in anions in the channel with concentration, they are still excluded from the highly charged regions. Preservation of the cation–anion selectivity in the potassium channel is quite remarkable for PNP, especially when compared to Fig. 12 B. This is due to the large amount of fixed charge in the protein wall, which dominates the electrostatic forces and diminishes the role of boundary forces. While being helpful in suppressing the anion current in a natural way, this situation is, in fact, a mixed blessing for a continuum theory, since it creates a multi-ion environment where the ion–ion interactions seem to be playing a crucial role in ion permeation (Chung et al., 1999). Because the ion–ion interactions are washed out in the mean-field approximation, such an intricate behavior of ions cannot be modeled within the PNP approach.
CONCLUSIONS
In this article we have presented extensive comparisons of PNP theory with BD simulations using a variety of channel shapes and conditions. Our main conclusion, as in the companion article, is that shielding does not play any role in ion permeation in narrow channels, and that the shielding seen in PNP theory is largely a chimera of its continuum assumptions rather than a real feature of the underlying physics. This is mostly clearly shown in bare cylindrical channels, where the uniform occupation of the channel by cations and anions in PNP leads to perfect shielding and thus no ion– channel interaction. However, in BD simulations, where ions are treated as discrete entities, it is found that counterions cannot provide any shielding and so ions hardly ever enter the channel due to the repulsive ionchannel interaction. Consequently, PNP theory fails in its predictions of physically observable quantities. In more formal terms, the time averages of concentration and potential profiles obtained from the BD simulations are in complete disagreement with the PNP predictions, and hence the mean-field approximation in PNP breaks down in narrow
Poisson–Nernst–Planck versus Brownian Dynamics 2379
Biophysical Journal 78(5) 2364 –2381


channels. A convergence between the two theories occurs only in wide channels with radius 2–3 Debye lengths (11–17 Å for a 300 mM solution). Agreement arises in wide channels simply because bulk conditions prevail. Besides the channel radius, a second parameter that has a significant influence on ion permeation is the amount of fixed charge in the protein wall. In PNP, fixed charges spoil the coexistence of cations and anions in the channel, and thereby reduce the false shielding effects. When moderate amounts of fixed charge are present, as in most applications of PNP, there is some improvement in the PNP results (e.g., the I-V curve in Fig. 11 A), but in most aspects it still fails the tests (e.g., anion conductance in Fig. 11 B and saturation of conductance in Fig. 12). Comparisons in the potassium channel provide a test of PNP in the high-charge limit. Here, finally, the problem with the anion conductance is resolved, and the discrepancies between PNP and BD are quite small considering the fact that it is a rather narrow channel. Nevertheless, PNP still cannot reproduce the saturation of conductance, due to shielding becoming significant again with increasing concentration. Another problem in the application of PNP to the potassium channel is that it is occupied with multiple ions whose interactions are ignored in PNP. Our results demonstrate clearly that ions in a narrow pore formed by the protein wall must be treated as individual particles carrying an elementary charge ze. Their representation as a continuous charge density, as in the PNP theory, leads to erroneous results. The physical interpretation of the process of ion permeation across a narrow channel given by the PNP theory does not reflect the reality. In this respect, a match between experimentally determined current–voltage relationships and those calculated from the PNP theory by adjusting several free parameters is fortuitous. Some of the parameters used in many applications of PNP, such as the diffusion coefficients of different ionic species, are not in a physically allowed range (for example, Nonner and Eisenberg, 1998; Chen et al., 1997, 1999). Thus, the error committed by an inappropriate application of the PNP theory outside its domain of validity is remedied by adopting physically unrealistic values of the diffusion coefficients of ions. This point will be discussed in detail in a forthcoming article, where diffusion coefficients of a variety of biologically important ions are estimated from molecular dynamics simulations in both schematic cylindrical channels and in a realistic potassium channel, as given by Doyle et al. (1998). Brownian dynamics provides a viable alternative for description of ion permeation in channels. In the past, it has been applied to toroidal (Li et al., 1998) and catenary (Chung et al., 1998; Hoyles et al., 1998a) shaped channels as well as the potassium channel (Chung et al., 1999). We hope that it will be used more frequently in future studies of ion channels both in interpretation of the channel data and for a better understanding of the physics of ion channels.
APPENDIX
Algorithms for solving PNP equations
The coupled PNP equations in three dimensions (1 and 2) are solved using finite difference methods similar to those used for the PB equation in article I. A similar algorithm was also used by Kurnikova et al. (1999). The system is discretized by placing a rectangular grid of points with cell dimensions hx  hy  hz over the channel and reservoirs. All the physical quantities (e.g., potential, flux, and number density of ions, etc.) are approximated by discrete values at the grid points which represent their average over the cell volume. Poisson’s equation (2) is discretized in the same way as in the Appendix of article I by integrating it over a cell of volume V  hxhyhz centered at a grid point ri, and using Gauss’ theorem, which gives

j1
6
0j
ri  hj jˆ  ri
hj
V
hj
 V  
zenri  qi.
Here the j sum is over the six surfaces of the rectangular box with h1  h4  hx, h2  h5  hy, h3  h6  hz, and jˆ  xˆ, yˆ, zˆ for j  1, 2, 3, and xˆ, yˆ, zˆ for j  4, 5, 6. On the right-hand side of the equation, the  sum is over the ion species and qi is the total external charge contained in the cell volume. Solving for the central potential, we can relate it to its immediate neighbors as
i  j jj/hj
2   zeni/0  qi/0V

j j/hj
2 , (14)
where the subscripts i and j on , , and n refer to the grid positions ri and ri  hjjˆ, respectively. Discretization of the Nernst–Planck equation is even simpler since it involves only the first derivatives in number density and potential. Using the definition of grid points and its neighbors introduced above, the NP equation (1) can be readily converted to the following finite difference equation at the ith grid point
Jj  Dnj  ni
hj
 ze
kT
1
2 nj  ni j  i
hj , (15)
where Jj, j  1, . . . , 6 denotes the flux through each of the six surfaces of the rectangular box at ri, and an average of the densities in the cells i and j is used in the last term. Here we have suppressed the subscript  for ion species for convenience. Otherwise, an identical equation is obtained for each ion species. Under steady-state conditions   J  0, and the total flux of each ion species from any grid point must vanish, that is, j1
6 Jj  0. Using this condition with Eq. 15 and solving for the density at the central grid point gives
ni  j1
6 1/hj  ez/2kTj  i/hj nj

j1
6 1/hj  ez/2kTj  i/hj
, (16)
which relates the density at a grid point to its immediate neighbors. Clearly, the sum over all six surfaces applies when all the neighboring grid points are in the electrolyte. Because there can be no flux through the boundary, grid points that lie outside the electrolyte are excluded from the sums in Eq. 16. Equations 14 and 16 are solved simultaneously using an iterative scheme: starting with some initial guesses for the concentration and potential values at all the grid points and successively updating them until they converge to stable values. The convergence criterion used is that the maximum change in both concentration and potential between successive iterations at any grid point is smaller than the tolerance value, which is typically set to 107 V for potential and 107 M for concentration. To
2380 Corry et al.
Biophysical Journal 78(5) 2364 –2381


speed up convergence, we use the Gauss–Seidal method with over- or under-relaxation (see the Appendix of article I for an explanation of these terms). Over-relaxation is used in most cases for faster convergence. Exceptions occur in the presence of large fixed charges in the channel (e.g., potassium channel), which lead to instabilities in the iterative procedure, and require use of under-relaxation to achieve convergence. The algorithm requires specification of the concentration and potential values along the boundary of the computational box. For this purpose we assign the constant concentration values of cL and cR to the boundaries on the left and right reservoirs, and a zero value for the protein. The potential along the boundary is determined similarly; the top and bottom of the computational box are assigned values according to the potential drop across the system, and the potential is varied linearly between these values along the side boundaries. While these simple choices lead to some inaccuracies near the sides of the reservoirs, they have no discernible effect on the channel results because the radius of the reservoir is sufficiently large. An accurate implementation of the boundary conditions on the sides can be achieved by extending the grid system in the radial direction beyond the reservoir. Naturally, this comes at an increased computational cost, and since it is unwarranted, we have not used it in this study.
The calculations upon which this work is based were carried out using the Fujitsu VPP-300 and the Linux  cluster of the ANU Supercomputer Facility.
This work was supported by grants from the Australian Research Council and the National Health and Medical Research Council of Australia.
REFERENCES
Ashcroft, N. W., and N. D. Mermin. 1976. Solid State Physics. Holt, Rinehart and Winston, New York.
Bek, S., and E. Jakobsson. 1994. Brownian dynamics study of a multiply occupied cation channel: application to understanding permeation in potassium channel. Biophys. J. 66:1028 –1038.
Bockris, J. O’M., and A. K. N. Reddy. 1970. Modern Electrochemistry, Vol. 1. Plenum, New York.
Chen, D., J. Lear, and R. S. Eisenberg. 1997. Permeation through an open channel: Poisson–Nernst–Planck theory of a synthetic ionic channel. Biophys. J. 72:97–116.
Chen, D. P., L. Xu, A. Tripathy, G. Meissner, and B. Eisenberg. 1999. Selectivity and permeation in calcium release channel of cardiac muscle: alkali metal ions. Biophys. J. 76:1346 –1366.
Chung, S. H., T. W. Allen, M. Hoyles, and S. Kuyucak. 1999. Permeation of ions across the potassium channel: Brownian dynamics studies. Biophys. J. 77:2517–2533.
Chung, S. H., M. Hoyles, T. W. Allen, and S. Kuyucak. 1998. Study of ionic currents across a model membrane channel using Brownian dynamics. Biophys. J. 75:793– 809.
Cooper, K. E., P. Y. Gates, and R. S. Eisenberg. 1988. Surmounting barriers in ionic channels. Q. Rev. Biophys. 21:331–364.
Cooper, K. E., E. Jakobsson, and P. Wolynes. 1985. The theory of ion transport through membrane channels. Prog. Biophys. Mol. Biol. 46: 51–96.
Corry, B., S. Kuyucak, and S. H. Chung. 1999. Test of Poisson–Nernst–Planck theory in ion channels. J. Gen. Physiol. 114: 597–599.
Doyle, D. A., J. M. Cabral, R. A. Pfuetzner, A. Kuo, J. M. Gulbis, S. L. Cohen, B. T. Chait, and R. MacKinnon. 1998. The structure of the potassium channel: molecular basis of K conduction and selectivity. Science. 280:69 –77.
Eisenberg, R. S. 1996. Computing the field in proteins and channels. J. Membr. Biol. 150:1–25.
Eisenberg, R. S. 1999. From structure to function in open ionic channels. J. Membr. Biol. 171:1–24.
Hall, J. 1975. Access resistance of a small circular pore. J. Gen. Physiol. 66:531–532. Hille, B. 1992. Ionic Channels of Excitable Membranes, 2nd Ed. Sinauer Associates Inc., Sunderland, MA. Hoyles, M., S. Kuyucak, and S. H. Chung. 1996. Energy barrier presented to ions by the vestibule of the biological membrane channel. Biophys. J. 70:1628 –1642. Hoyles, M., S. Kuyucak, and S. H. Chung. 1998a. Computer simulation of ion conductance in membrane channels. Phys. Rev. E. 58:3654 –3661. Hoyles, M., S. Kuyucak, and S. H. Chung. 1998b. Solutions of Poisson’s equation in channel-like geometries. Computer Phys. Commun. 115: 45– 68. Jakobsson, E., and S. W. Chiu. 1987. Stochastic theory of ion movement in channels with single-ion occupancy. Biophys. J. 52:33– 45. Kurnikova, M. G., R. D. Coalson, P. Graf, and A. Nitzan. 1999. A lattice relaxation algorithm for three-dimensional Poisson–Nernst–Planck theory with application to ion transport through the gramicidin A channel. Biophys. J. 76:642– 656.
Levitt, D. G. 1986. Interpretation of biological ion channel flux data: reaction-rate versus continuum theory. Annu. Rev. Biophys. Biophys. Chem. 15:29 –57. Levitt, D. G. 1991a. General continuum theory for multiion channel. I. Theory. Biophys. J. 59:271–277. Levitt, D. G. 1991b. General continuum theory for multiion channel. II. Application to acetylcholine channel. Biophys. J. 59:278 –288. Levitt, D. G. 1999. Modeling of ion channels. J. Gen. Physiol. 113: 789 –794. Li, S. C., M. Hoyles, S. Kuyucak, and S. H. Chung. 1998. Brownian dynamics study of ion transport in the vestibule of membrane channels. Biophys. J. 74:37– 47.
Mason, E., and E. McDaniel. 1988. Transport Properties of Ions in Gases. John Wiley, New York. McClesky, E. W. 1999. Calcium channel permeation: a field in flux. J. Gen. Physiol. 113:765–772.
Miller, C. 1999. Ionic hopping defended. J. Gen. Physiol. 113:783–787. Moy, G., B. Corry, S. Kuyucak, and S. H. Chung. 2000. Tests of continuum theories as models of ion channels. I. Poisson–Boltzmann theory versus Brownian dynamics. Biophys. J. 78:2349 –2363. Newman, J. S. 1991. Electrochemical Systems. Prentice Hall, Englewood Cliffs, NJ. Nonner, W., D. P. Chen, and B. Eisenberg. 1999. Progress and prospects in permeation. J. Gen. Physiol. 113:773–782. Nonner, W., and R. S. Eisenberg. 1998. Ion permeation and glutamate residues linked by Poisson–Nernst–Planck theory in L-type calcium channels. Biophys. J. 75:1287–1305. Rae, J. L., R. A. Levis, and R. S. Eisenberg. 1988. Ionic channels in ocular epithelia. In Ion Channels, Vol. 1. T. Narahashi, editor. Plenum Press, New York. 283–327. Roux, B., and M. Karplus. 1994. Molecular dynamics simulations of the gramicidin channel. Annu. Rev. Biophys. Biomol. Struct. 23:731–761. Syganow, A., and E. von Kitzing. 1995. Integral weak diffusion and diffusion approximations applied to ion transport through biological ion channels. J. Phys. Chem. 99:12030 –12040. Syganow, A., and E. von Kitzing. 1999a. (In)validity of the constant field and constant current assumptions in theories of ion transport. Biophys. J. 76:768 –781. Syganow, A., and E. von Kitzing. 1999b. The drift approximation solves the Poisson, Nernst–Planck, and continuum equations in the limit of large external voltages. Eur. Biophys. J. 28:393– 414. van Gunsteren, W. F., and H. J. C. Berendsen. 1982. Algorithms for Brownian dynamics. Mol. Phys. 45:637– 647. Weiss, T. F. 1996. Cellular Biophysics, Vols. 1, 2. MIT Press, Cambridge, MA.
Poisson–Nernst–Planck versus Brownian Dynamics 2381
Biophysical Journal 78(5) 2364 –2381